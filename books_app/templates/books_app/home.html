{% extends "books_app/base.html" %}

{% block body_class %}home-page{% endblock %}
{# By adding a class to the body, we can apply page-specific styles from base.html #}
 
{% block title %}Home - eBooks{% endblock %}

{% block content %}
  <div class="page-header">
    <h1>Available Books</h1>
    <p>Browse the collection or search for a specific title or author.</p>
  </div>

  <!-- Search Form -->
  <form method="get" action="{% url 'books_app:home' %}" class="search-form">
    <input type="text" name="q" placeholder="Search by title or author..." value="{{ query|default:'' }}">
    <button type="submit">Search</button>
  </form>

  <!-- This is the grid container -->
  <div class="book-grid">
    {% for book in books %}
        <!-- This is the new book item card -->
        <div class="book-item">
            {% if book.cover_image %}
                <img src="{{ book.cover_image.url }}" alt="Cover for {{ book.title }}" class="book-cover">
            {% else %}
                <!-- Placeholder for books without an image -->
                <div class="book-cover" style="background-color: #e9ecef; display: flex; align-items: center; justify-content: center;">
                    <span>No Image</span>
                </div>
            {% endif %}
            <div class="book-details">
                <h2>{{ book.title }}</h2>
                <p>by {{ book.author }}</p>
            </div>
            <!-- Download button for the actual book file -->
            {% if book.book_file %}
                <a href="{{ book.book_file.url }}" class="download-button" download>Download Book</a>
            {% endif %}
            
        </div>
    {% empty %}
        <div class="no-results">
            <h3>No Books Found</h3>
            <p>There are no books matching your search for "<strong>{{ query }}</strong>". Try a different search or <a href="{% url 'books_app:request_book' %}">request a new book</a>.</p>
        </div>
    {% endfor %}
  </div>
{% endblock %}